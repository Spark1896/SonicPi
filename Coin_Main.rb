#A version of "Toss a Coin to Your Witcher" remixed to a Eurobeat style
#Requires Coin_perc.rb for percussion function defenitions
#Run Coin_perc.rb first, followed by this script
define :plar do |nos, len, rest, size, cut = 100|
  a = 0
  size.times do
    play nos[a], release: len[a]*0.2, sustain: len[a]*0.8, pan: -0.5, cutoff: cut
    sleep rest[a]
    a = inc a
  end
end
qe = [0.5,0.5,0.5,0.5]
me = qe+qe
define :mintro do
  with_fx :level, amp: 0.6 do
    notes = [73,72,70,68, 70,75,75,73,72,
             70,70,75,75,77, 73,70,70,70,68,70,73,75,73,75, 75,77]
    len = qe+[2,0.5,0.5,0.5,0.5,
              1.5,0.5,0.5,0.5,1, 0.5,0.5,0.5,0.25,0.25,0.25,0.25,0.5,0.5,0.5, 0.5,1.5]
    rests = qe+[2,0.5,0.5,0.5,0.5,
                1.5,0.5,0.5,0.5,1, 0.5,0.5,0.5,0.25,0.25,0.25,0.25,0.5,0.5,2.5, 0.5,1.5]
    sleep 2
    plar notes, len, rests, 26, 130
    sleep 4
  end
end
define :mver1 do
  with_fx :level, amp: 0.9 do
    notes = [70,73,72,70,68, 70,70,73,75,72, 68,70,70,75,75,77,73, 70,70,75,75,75,77, 73,70, #25
             73,72,73,72,70,68, 70,72,70,73,75,72,72, 70,68,70,75,75,77,73, 70,70,80,77,73,75, 77,         #22
             73,72,70,68, 70,72,70,73,75,72,72, 70,70,75,75,77,73, 70,75,73,75,75, 77]            #21
    len = [0.5,0.75,0.25,0.5,0.5, 1.5,0.5,0.5,0.5,1, 0.5,1]+qe+[1, 1]+qe+[3.5, 0.5,2.5, 0.25,0.25]+
      qe+ [1.5,0.25,0.25]+qe+ [1.5,0.25,0.25,0.5,0.5,0.5,1, 1,0.5]+qe+ [2,0.75,0.25,0.25,0.75, 1.5,0.25,0.25]+qe+ [1.5,0.5]+qe+ [2]+qe+ [4]
    rests = [0.5,0.75,0.25,0.5,0.5, 1.5,0.5,0.5,0.5,1, 0.5,1]+qe+[1, 1]+qe+[3.5, 0.5,6, 0.25,0.25]+
      qe+ [1.5,0.25,0.25]+qe+ [1.5,0.25,0.25,0.5,0.5,0.5,1, 1,0.5]+qe+ [2,0.75,0.25,0.25,0.75, 1.5,0.25,0.25]+qe+ [1.5,0.5]+qe+ [2]+qe+ [4]
    sleep 1.5
    plar notes, len, rests, 75, 100
  end
end
define :mver2 do
  with_fx :level, amp: 0.8 do
    sleep 1.5
    notes = [68,70,73,72,70,68, 70,72,73,75,75,73,72, 70,70,75,75,77,73, 70,70,75,73,75,75, 77, #23
             70,72,73,72,70,68, 70,70,72,73,75,72,72, 70,70,75,75,77,73, #15
             70,75,73,75,75, 77, 81,82, 73,72,70,68, 70,73,75,72,72,    #17
             70,70,70,75,75,77,73, 70,70,70,75,73,75,75, 77,73,72,70,68, #19
             70,70,73,75,72,72, 70,70,75,75,77,73, 70,70,80,77,75,75, 77] #19
    len = [0.25,0.25]+qe+ [1.5,0.25,0.25]+qe+ [1.5]+qe+[1, 1,0.5]+qe+ [4,0.25,0.25] +qe+ [1,0.25,0.25]+qe+ [1]+qe+[1, 1.5]+qe+ [4, 0.5,0.5]+ qe+ [1]+qe+
      [1,0.5]+qe+[0.75, 0.25,1,0.5]+qe+ [1,0.5,0.5,0.25,0.75, 1,0.5]+qe+ [1]+qe+[1, 1,0.5]+qe+ [3]
    rests = [0.25,0.25]+qe+ [1.5,0.25,0.25]+qe+ [1.5]+qe+[1, 1,0.5]+qe+ [9.5,0.25,0.25] +qe+ [1.5,0.25,0.25]+qe+ [1.5]+qe+[1, 1.5]+qe+ [7,0.5,2.5]+ qe+ [2]+qe+
      [1,0.5]+qe+[0.75, 0.25,1,0.5]+qe+ [2,0.5,0.5,0.25,0.75, 1.5,0.5]+qe+ [1.5]+qe+[1, 1,0.5]+qe+ [3]
    plar notes, len, rests, 100, 100
  end
  
end
define :mchor1 do
  with_fx :level, amp: 0.8 do
    notes = [70,73,77,75,73, 75,77,77,75,73,72,73, 70,77,75,73,72,73, 70,68,70,73,
             70,73,77,75,73, 75,77,77,80,77,75,77, 77, [81,77,72], 82]
    len = [0.5,0.5,1,0.5,0.5, 0.5,1,0.5,0.5,0.5,0.5,1, 1,0.5,0.5,0.5,0.5,1, 1,0.5,0.5,1.5,
           0.5,0.5,1,0.5,0.5, 0.5,1,0.5,0.5,0.5,0.5,1, 3.5, 4, 4]
    rests = [0.5,0.5,1,0.5,0.5, 0.5,1,0.5,0.5,0.5,0.5,1, 1,0.5,0.5,0.5,0.5,1, 1,0.5,0.5,2.5,
             0.5,0.5,1,0.5,0.5, 0.5,1,0.5,0.5,0.5,0.5,1, 3.5, 4, 4]
    sleep 1
    plar notes, len, rests, 37, 115
  end
end
define :mchor2 do
  with_fx :level, amp: 0.8 do
    notes = [70,73,77,75,73, 75,77,77,75,73,72,73, 70,77,75,73,72,73, 70,68,70,73, #22
             70,73,77,75,73, 75,77,77,80,77,75,77, 77,77, 81,82,                   #16
             70,73,77,75,73, 75,77,77,75,73,72,73, 70,77,75,73,72,73, 70,68,70,73, #22
             70,73,77,75,73, 75,77,77,80,77,75,77, 77,77, 81,81,82,                #17
             82,80,82,82,80, 82,85,77,75,73,72,73, 70,77,75,73,72,73, 70,68,70,73, #22
             82,80,82,82,80, 82,85,77,80,77,75,77, 77,77, 81,81,81,81,81,81,81,82, 82] #23
    len = [0.5,0.5,1,0.5,0.5, 0.5,1,0.5,0.5,0.5,0.5,1, 1,0.5,0.5,0.5,0.5,1, 1,0.5,0.5,1.5,
           0.5,0.5,1,0.5,0.5, 0.5,1,0.5,0.5,0.5,0.5,0.75, 0.25,3.5, 3.5,1.5,
           0.5,0.5,1,0.5,0.5, 0.5,1,0.5,0.5,0.5,0.5,1, 1,0.5,0.5,0.5,0.5,1, 1,0.5,0.5,1.5,
           0.5,0.5,1,0.5,0.5, 0.5,1,0.5,0.5,0.5,0.5,0.75, 0.25,3.5, 3,0.5,1.5,
           0.5,0.5,1,0.5,0.5, 0.5,1,0.5,0.5,0.5,0.5,1, 1,0.5,0.5,0.5,0.5,1, 1,0.5,0.5,1.5,
           0.5,0.5,1,0.5,0.5, 0.5,1,0.5,0.5,0.5,0.5,0.75, 0.25,3.5]+ me+ [4]
    rests = [0.5,0.5,1,0.5,0.5, 0.5,1,0.5,0.5,0.5,0.5,1, 1,0.5,0.5,0.5,0.5,1, 1,0.5,0.5,2.5,
             0.5,0.5,1,0.5,0.5, 0.5,1,0.5,0.5,0.5,0.5,0.75, 0.25,3.5, 3.5,1.5,
             0.5,0.5,1,0.5,0.5, 0.5,1,0.5,0.5,0.5,0.5,1, 1,0.5,0.5,0.5,0.5,1, 1,0.5,0.5,2.5,
             0.5,0.5,1,0.5,0.5, 0.5,1,0.5,0.5,0.5,0.5,0.75, 0.25,3.5, 3,0.5,1.5,
             0.5,0.5,1,0.5,0.5, 0.5,1,0.5,0.5,0.5,0.5,1, 1,0.5,0.5,0.5,0.5,1, 1,0.5,0.5,2.5,
             0.5,0.5,1,0.5,0.5, 0.5,1,0.5,0.5,0.5,0.5,0.75, 0.25,3.5]+ me+ [4]
    sleep 1
    plar notes, len, rests, 122, 120
  end
end
define :mel do
  use_synth :prophet
  mintro
  mver1
  mchor1
  mver2
  mchor2
end

define :hintro do
  sleep 24
end
define :hver1 do
  sleep 60
end
define :hver2 do
  sleep 1.5
  notes = [70,73,72,70,68, 70,75,75,73,72, 70,70,75,75,77,73, 70,70,75,73,75,75, 77, #23
           70,77,75,77,73,72,70,68, 70,77,75,77,73,75,72,72, 70,77,75,70,75,75,77,73, #24
           70,75,73,75,75, 77,75,67,75,67,75,67,75, 68,77,68,75,69,77,[81,69],[82,70], #21
           [70,65,61,58],77,75,77,73,72,70,68, [70,66,63,58], 77,75,77,73,75,72,72,    #16
           [70,65,63,58],70,70,75,75,77,73, [68,65,61],70,70,70,[75,72,69,65],73,75,75, [77,73,70,65],77,75,77,73,72,70,68, #23
           [70,67,63,58],77,75,70,73,75,72,72, [70,66,63,58],77,75,70,75,75,77,73, [68,65,61],70,70,[80,68],[77,65],[75,63],[75,63], [77,65]] #24
  len = [0.5]+qe+ [2]+qe+ [1.5]+qe+[1, 1,0.5]+qe+ [4] +me+ me+ qe+[0.5,0.5,0.5,1, 1.5]+qe+ me+ me+ me+ me+
    [1,0.5]+qe+[0.75, 0.25,0.25,1,0.5]+qe+ qe+[0.5,0.5,0.25,0.75] +me+ qe+[0.5,0.5,0.5,1, 0.5,1,0.5]+qe+ [3]
  rests = [0.5]+qe+ [2]+qe+ [1.5]+qe+[1, 1,0.5]+qe+ [8] +me+ me+ qe+[0.5,0.5,0.5,1, 1.5]+qe+ me+ me+ me+ me+
    [1,0.5,0.5]+qe+ [0.25,0.25,1,0.5]+qe+ qe+[0.5,0.5,0.25,0.75] +me+ me+ [0.5,1,0.5]+qe+ [3]
  plar notes, len, rests, 131, 95
end
define :hchor1 do
  sleep 28
  plar [[77,72],82], [4,4], [4,4], 2, 105
end
define :hchor2 do
  with_fx :level, amp: 0.5 do
    sleep 2
    notes = [72,73,72,73, [81,77,72],[82,70], 72,73,72,73, [81,77,72],77,75,77,75,77,[81,77,75,72],[82,73,70], #18
             70,73,77,75,73, 75,77,  70,73,[82,77,72],75,73, [82,75,73],77,77,77,73,72,73, 73,73,              #21
             [81,77,72],[81,77,72],[81,77,72],[81,77,72],[81,77,72],[81,77,72],[81,77,72],[82,77,73], [82,77,73]] #9
    len = [1,1,1,1, 3.5,1.5, 1,1,1,1, 3,0.5,0.5,0.5,0.5,0.5,0.5,1.5, 0.5,0.5,1,0.5,0.5, 0.5,1,
           0.5,0.5,1,0.5,0.5, 0.5,1,0.5,0.5,0.5,0.5,0.75, 0.25,3.5] +me+ [4]
    rests = [2,14,2,8, 3.5,2.5, 2,14,2,8, 0.5,0.5,0.5,0.5,0.5,0.5,0.5,1.5, 0.5,0.5,1,0.5,0.5, 0.5,12.5,
             0.5,0.5,1,0.5,0.5, 0.5,1,0.5,0.5,0.5,0.5,0.75, 0.25,3.5]+me+[4]
    plar notes, len, rests, 48, 110
  end
end
define :harm do
  use_synth :blade
  hintro
  hver1
  hchor1
  hver2
  hchor2
end

define :bintro do
  with_fx :level, amp: 0.75 do
    notes = [[70,65,61,58], [67,63,58], [66,63,58], [65,60,56], [65,63,58], [65,60,56], [65,60,57]]
    len   = [4, 4, 4, 4, 4, 2,2]
    plar notes, len, len, 7, 90
  end
end
define :bver1 do
  with_fx :level, amp: 0.5 do
    dubs = [0.5,0.5]
    plar [58,65], dubs, dubs, 2, 81
    3.times do plar [58,63], dubs, dubs, 2,81 end #bf
    plar [55,65], dubs, dubs, 2,82
    3.times do plar [55,63], dubs, dubs, 2,82 end #g
    plar [54,65], dubs, dubs, 2,83
    3.times do plar [54,63], dubs, dubs, 2,83 end #gf
    plar [56,65], dubs, dubs, 2,84
    3.times do plar [56,63], dubs, dubs, 2,84 end #af
    plar [55,65], dubs, dubs, 2,85
    3.times do plar [55,63], dubs, dubs, 2,85 end #g
    plar [56,65], dubs, dubs, 2,86
    2.times do plar [56,63], dubs, dubs, 2,86 end #aftrans
    plar [57,63], dubs, dubs, 2,87
    plar [58,65], dubs, dubs, 2,87
    3.times do plar [58,63], dubs, dubs, 2,87 end #bf
    plar [55,65], dubs, dubs, 2,88
    3.times do plar [55,63], dubs, dubs, 2,88 end #g
    plar [54,65], dubs, dubs, 2,89
    3.times do plar [54,63], dubs, dubs, 2,89 end #gf
    plar [56,65], dubs, dubs, 2,90
    2.times do plar [56,63], dubs, dubs, 2,90 end #aftrans
    plar [57,63], dubs, dubs, 2,91
    plar [58,65], dubs, dubs, 2,91
    3.times do plar [58,63], dubs, dubs, 2,91 end #bf
    plar [55,65], dubs, dubs, 2,92
    3.times do plar [55,63], dubs, dubs, 2,92 end #g
    plar [54,65], dubs, dubs, 2,93
    3.times do plar [54,63], dubs, dubs, 2,93 end #gf
    plar [56,65], dubs, dubs, 2,94
    3.times do plar [56,63], dubs, dubs, 2,94 end #af
    notes = [[68,63,60,56],60,60,60,60,60,[65,60],60]
    plar notes, me, me, 8,95
  end
end
define :bver2 do
  with_fx :level, amp: 0.5 do
    sleep 3
    notes = [63,65,63,61,60, [70,65,61,58],65,58,63,58,63,58,63, #13
             [67,63,58,55],65,55,65,55,65,55,65, [66,63,58,54],65,54,65,54,65,54,65, #16
             [68,65,60,56],65,56,65,56,65,56,65, [67,63,58,55],65,55,65,55,65,55,65, #16
             [72,68,65,60],65,56,65,[72,69,65,60],63,63,65,63,61,60, #11
             [58,53,49,46],65,63,65,61,65,60,65, [67,63,58,55],65,63,65,61,65,60,65, #16
             [66,63,58,54],65,63,65,61,65,60,65, [68,65,60,56],65,63,65,61,65,60,65, #16
             [67,63,58,55],65,55,65,55,65,55,65, [60,56,53,48],65,56,63,[60,57,53,48],65,56,63,
             [58,53,46],65,[58,53],63,[58,53],63,[58,53],63, [55,51,43],65,[55,51],63,[55,51],63,[55,51],63, #16
             [54,51,42],65,[54,51],63,[54,51],63,[54,51],63, [56,53,44],65,[56,53],63,[57,53,45],65,[57,53],63, #16
             [58,53,46],65,[58,53],63,[58,53],63,[58,53],63, [55,51,43],65,[55,51],63,[55,51],63,[55,51],63, #16
             [54,51,42],65,[54,51],63,[54,51],63,[54,51],63, [56,53,44],65,[56,53],63,[56,53],63,[56,53],63] #16
    len = [0.125,0.125,0.25,0.25,0.25]+me+ me+ me+ me+ me+ qe+[0.5,0.5,0.125,0.125,0.25,0.25,0.25]+
      me+ me+ me+ me+ me+ me+ me+ me+ me+ me+ me+ me+ me+ me
    plar notes, len, len, 168, 100
  end
  with_fx :level, amp: 0.75 do
    notes = [[68,63,60,56],[68,63,60,56],[68,63,60,56],[68,63,60,56], [69,65,60,57],[69,65,60,57]]
    len = qe+[0.5,0.5]
    plar notes, len, len, 6, 105
  end
end
define :b1chor1 do
  with_fx :level, amp: 0.5 do
    notes = [[70,65,61,58],[69,65,60], [68,65,61],[67,61,58],
             [70,65,61],[69,65,60], [68,65,61],[67,61,58],[70,65,61,58],
             [69,65,60,57],[69,65,60,57],[69,65,60,57],[69,65,60,57],[69,65,60,57]]
    len = [2,2, 1,2.5, 2,2, 2,1.5,1, 0.5]+qe
    rests = [2,2, 1.5,10.5, 2,2, 2,1.5,4.5] +qe+[2]
    plar notes, len, rests, 14, 100
  end
end
define :b2chor1 do
  sleep 8
  with_fx :level, amp: 0.4 do
    notes = [46,53,61,58,65,58,61,53, 46,53,58,60,61,60,58,
             53,58,61,57,60,57, 61,65,68, 53,58,53,65,53,58,56]
    len = me+ qe+[0.5,0.5,0.5, 0.5,0.5,0.5,0.5,0.5,0.5,  0.5,0.5,0.5,  0.5,0.5,0.5]+qe
    rests = me+ qe+[0.5,0.5,1.5, 0.5,0.5,1,0.5,0.5,1,  0.5,0.5,3,  0.5,0.5,0.5]+qe
    plar notes, len, rests, 31, 105
  end
end
define :b1chor2 do
  with_fx :level, amp: 0.5 do
    notes = [[70,65,61,58],[69,65,60,57], [68,65,61,56],[67,61,58,55],
             [65,61,58,53],[67,61,58,55], [65,61,58,53],[67,61,58,55],
             [70,65,61,58],[69,65,60,57], [68,65,61,56],[67,61,58], [70,65,61,58],
             [69,65,60,57],[69,65,60,57],[69,65,60,57],[69,65,60,57],[69,65,60,57],
             [70,65,61,58],[69,65,60,57], [68,65,61,56],[67,61,58,55],
             [65,61,58],[67,61,58], [65,61,58],[67,61,58],
             [70,65,61,58],[69,65,60,57], [68,65,61,56],[67,61,58], [70,65,61,58], [69,65,60,57],
             [70,65,61,58],[69,65,60,57], [68,65,61,56],[67,61,58],
             [65,61,58],[67,61,58], [65,61,58],[67,61,58],
             [70,65,61,58],[69,65,60,57], [68,65,61,56],[67,61,58], [70,65,61,58],
             [69,65,60,57],[69,65,60,57],[69,65,60,57],[69,65,60,57],[69,65,60,57],[69,65,60,57],[69,65,60,57],[70,65,61,58],
             [70,65,61,58]]
    len = [2,2, 2,2, 2,2, 2,2, 2,2, 2,2, 4, 0.5]+qe+
      [2,2, 2,2, 2,2, 2,2, 2,2, 2,2, 4, 4, 2,2, 2,2, 2,2, 2,2, 2,2, 2,2, 4] +me+ [4]
    rests = [2,2, 2,2, 2,2, 2,2, 2,2, 2,2, 4] +qe+[2, 2,2, 2,2, 2,2, 2,2, 2,2, 2,2, 4, 4, 2,2, 2,2, 2,2, 2,2, 2,2, 2,2, 4] +me+ [4]
    
    plar notes, len, rests, 54, 100
  end
end
define :b2chor2 do
  with_fx :level, amp: 0.4 do
    sleep 0.5
    notes = [61,65,61,63,65,63, 61,65,68,58,61,58, 53,58,60,60,58,53, 53,58,60,53,58,53, #24
             53,58,61,56,60,56, 61,65,68,70,73,70, 53,58,53,65,53,58,56, 65,68,72,       #22
             65,63,65,65,60,65, 65,63,65,65,60,65, 65,63,65,65,60,65, 65,63,65,65,60,65, #24
             65,63,65,65,60,65, 65,63,65,65,60,65, 65,60,65,61,65,58,65, 65,63,65,63,65,63,61, #26
             61,65,61,63,65,63, 61,65,68,58,61,58, 53,58,60,60,58,53, 53,58,60,53,58,53, #24
             53,58,61,56,60,56, 61,65,68,65,61,65, 53,58,53,65,53,58,56]                 #19
    len = [0.5,0.5,0.5,0.5,0.5,0.5, 0.5,0.5,0.5,0.5,0.5,0.5, 0.5,0.5,0.5,0.5,0.5,0.5, 0.5,0.5,0.5,0.5,0.5,0.5,
           0.5,0.5,0.5,0.5,0.5,0.5, 0.5,0.5,0.5,0.5,0.5,0.5, 0.5,0.5,0.5,0.5,0.5,0.5,0.5, 0.5,0.5,0.5,
           0.5,0.5,0.5,0.5,0.5,0.5, 0.5,0.5,0.5,0.5,0.5,0.5, 0.5,0.5,0.5,0.5,0.5,0.5, 0.5,0.5,0.5,0.5,0.5,0.5,
           0.5,0.5,0.5,0.5,0.5,0.5, 0.5,0.5,0.5,0.5,0.5,0.5, 0.5,0.5,0.5,0.5,0.5,0.5,0.5, 0.5,0.5,0.5,0.5,0.5,0.5,0.5,
           0.5,0.5,0.5,0.5,0.5,0.5, 0.5,0.5,0.5,0.5,0.5,0.5, 0.5,0.5,0.5,0.5,0.5,0.5, 0.5,0.5,0.5,0.5,0.5,0.5,
           0.5,0.5,0.5,0.5,0.5,0.5, 0.5,0.5,0.5,0.5,0.5,0.5, 0.5,0.5,0.5,0.5,0.5,0.5,0.5]
    rests = [0.5,0.5,1,0.5,0.5,1, 0.5,0.5,1,0.5,0.5,1, 0.5,0.5,1,0.5,0.5,1, 0.5,0.5,1,0.5,0.5,1,
             0.5,0.5,1,0.5,0.5,1, 0.5,0.5,1,0.5,0.5,1, 0.5,0.5,0.5,0.5,0.5,0.5,3, 0.5,0.5,0.5,
             0.5,0.5,1,0.5,0.5,1, 0.5,0.5,1,0.5,0.5,1, 0.5,0.5,1,0.5,0.5,1, 0.5,0.5,1,0.5,0.5,1,
             0.5,0.5,1,0.5,0.5,1, 0.5,0.5,1,0.5,0.5,1, 0.5,0.5,0.5,0.5,0.5,0.5,1, 0.5,0.5,0.5,0.5,0.5,0.5,1,
             0.5,0.5,1,0.5,0.5,1, 0.5,0.5,1,0.5,0.5,1, 0.5,0.5,1,0.5,0.5,1, 0.5,0.5,1,0.5,0.5,1,
             0.5,0.5,1,0.5,0.5,1, 0.5,0.5,1,0.5,0.5,1, 0.5,0.5,0.5,0.5,0.5,0.5,8.5]
    plar notes, len, rests, 139, 105
  end
end
define :bass do
  use_synth :tb303
  bintro
  bver1
  in_thread do
    b2chor1
  end
  b1chor1
  bver2
  in_thread do
    b2chor2
  end
  b1chor2
end


use_bpm 160
comment do
  use_synth :prophet
  in_thread do
    use_synth :noise
    pchor1
  end
  in_thread do
    with_fx :level, amp: 2 do
      use_synth :blade
      hchor1
    end
  end
  in_thread do
    use_synth :tb303
    in_thread do
      b2chor1
    end
    b1chor1
  end
  mchor1
end
#comment do
in_thread do
  bass
end
in_thread do
  harm
end
in_thread do
  perc
end
mel
#end
